<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What do you think?</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .logo {
            text-align: center;
            margin-bottom: 20px;
        }
        .logo img {
            max-width: 150px;
            height: auto;
        }
        h1 {
            font-size: 24px;
            color: #333;
            text-align: center;
            margin-bottom: 20px;
        }
        .question-block {
            margin-bottom: 30px;
        }
        h2 {
            font-size: 18px;
            color: #333;
            text-align: left;
            margin-bottom: 20px;
        }
        .slider {
            width: 100%;
            margin: 10px 0;
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            appearance: none;
        }
        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            background: #0063A7;
            border-radius: 50%;
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #0063A7;
            border-radius: 50%;
            cursor: pointer;
        }
        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #033C5A;
        }
        .answers {
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .answer-button {
            background-color: #0063A7;
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1 1 calc(50% - 10px);
            text-align: center;
            transition: background-color 0.3s, transform 0.1s;
        }
        .answer-button.selected {
            background-color: #033C5A;
            transform: translateY(2px);
        }
 button {
    background-color: #0063A7; /* Button background color */
    color: #fff; /* Text color */
    border: none; /* Remove border */
    padding: 15px 30px; /* Increase padding for a larger button */
    font-size: 14px; /* Make text bigger */
    font-weight: bold; /* Optional: Make the text bold */
    border-radius: 8px; /* Add rounded corners */
    cursor: pointer; /* Pointer cursor on hover */
    position: relative; /* Allow fine control */
    display: block; /* Ensure the button behaves as a block */
    margin: 10px 0 0 auto; /* Align to the right with margin at the top */
    text-align: center; /* Center the text */
    width: fit-content; /* Ensure button only takes up as much space as needed */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); /* Optional: Add a subtle shadow */
    transition: background-color 0.3s, transform 0.1s ease-in-out; /* Smooth hover effect */
}

button:hover {
    background-color: #0056b3; /* Darker shade on hover */
    transform: translateY(-2px); /* Slight upward movement on hover */
}

        .progress-bar-container {
    width: 100%;
    background-color: #f3f3f3;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-bar {
    height: 20px;
    width: 0%; /* Starts at 0% */
    background-color: #0063A7;
    border-radius: 10px;
    transition: width 0.3s ease;
}

.question-number {
    text-align: center;
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 30px;
    color: #033C5A;
}
        .input-field {
    width: 30%;
    padding: 8px;
    margin-bottom: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
}



    </style>
</head>
<body>

  <!-- Intro Page -->
<div id="intro-page" class="container">
    <div class="logo">
        <img src="logo.png" alt="Logo">
    </div>
    <h1>Welcome to the Questionnaire</h1>
    <p>
        In front of you are short stories describing different situations.<br>
        We ask that you <strong>think carefully</strong> about each one and choose the response that seems most appropriate to you.<br><br>
        <strong>There are no right or wrong answers.</strong> <br>
        Please answer according to your best judgment. If more than one answer feels right, <br>
        choose the one you feel most strongly about.
    </p>
    <!-- New Input Fields -->
    <label for="full-name">Full Name</label><br>
    <input type="text" id="full-name" placeholder="Enter your full name" class="input-field" required><br>
    
    <label for="class-name">Class</label><br>
<input type="text" id="class-name" placeholder="Enter your class" class="input-field" required><br>

    <button id="start-button">Start</button>
</div>

<!-- Main Questionnaire Section -->
<div id="questionnaire-page" class="container" style="display: none;">
    <div class="logo">
        <img src="logo.png" alt="Logo">
    </div>
    <h1>What do you think?</h1>
    <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div id="question-container"></div>
    <button id="submit-button">Next</button>
</div>

    <!-- Thank You Page -->
<div id="thank-you-page" class="container" style="display: none;">
    <div class="logo">
        <img src="logo.png" alt="Logo">
    </div>
    <h1>Thank You! <span id="thank-you-name">Participant</span>
<p>
    Thank you for taking the time to complete this questionnaire.<br>
    Your responses are valuable and appreciated!
</p>
</div>




<script>
const API_KEY = "$2a$10$YxiEwNJ1cRflkVspzTTu7.PUYSlzD01BRh1DFHGuaaJU9EJO1iH66";
const BIN_ID = "676119d6e41b4d34e466b66d";
const BIN_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

let currentQuestionIndex = 0;

// Function to save answers to JSONBin
async function saveAnswerToJSONBin(newData) {
    try {
        // Step 1: Get existing data
        const getResponse = await fetch(BIN_URL, {
            method: "GET",
            headers: { "X-Master-Key": API_KEY }
        });

        if (!getResponse.ok) throw new Error("Failed to fetch existing data");

        const existingData = await getResponse.json();
        const responses = existingData.record.responses || [];

        // Step 2: Append the new response
        responses.push(newData);

        // Step 3: Send updated data back to JSONBin
        const updateResponse = await fetch(BIN_URL, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json",
                "X-Master-Key": API_KEY
            },
            body: JSON.stringify({ responses })
        });

        if (!updateResponse.ok) throw new Error("Failed to update data");
        console.log("Data saved successfully!");
    } catch (error) {
        console.error("Error saving data:", error.message);
    }
}

// Function to load the question
function loadQuestion(index) {
    const question = questions[index];
    const container = document.getElementById("question-container");
    container.innerHTML = `
        <div class="question-block">
            <h2>${question.story}</h2>
            <p><strong>1:</strong> ${question.question1}</p>
            <input type="range" min="1" max="10" value="5" class="slider">
            <div class="slider-labels">
                <span>${question.sliderLabels[0]}</span>
                <span>${question.sliderLabels[1]}</span>
            </div>
            <br><br>
            <p><strong>2:</strong> ${question.question2}</p>
            <div class="answers">
                ${question.options.map(option => `<button class="answer-button">${option}</button>`).join("")}
            </div>
            <br>
            <p><strong>3:</strong> ${question.question3}</p>
            <div class="answers">
                ${question.options3.map(option => `<button class="answer-button">${option}</button>`).join("")}
            </div>
        </div>`;

    // Update Progress Bar
    const progressBar = document.getElementById("progress-bar");
    const progress = ((index + 1) / questions.length) * 100;
    progressBar.style.width = `${progress}%`;

    // Update Question Number
    const questionContainer = document.getElementById("question-container");
    questionContainer.insertAdjacentHTML('afterbegin', `
        <div class="question-number">
            Story ${index + 1} of ${questions.length}
        </div>
    `);
}

// Event listener to mark an answer as selected
document.getElementById("question-container").addEventListener("click", function (event) {
    if (event.target.classList.contains("answer-button")) {
        const answerGroup = event.target.closest(".answers");
        answerGroup.querySelectorAll(".answer-button").forEach(btn => btn.classList.remove("selected"));
        event.target.classList.add("selected");
    }
});

// Submit button event handler
document.getElementById("submit-button").addEventListener("click", function () {
    const sliderValue = document.querySelector(".slider").value;
    const selectedAnswers = document.querySelectorAll(".answer-button.selected");
    const answer1 = selectedAnswers[0]?.innerText || "Not Answered";
    const answer2 = selectedAnswers[1]?.innerText || "Not Answered";
    const fullName = localStorage.getItem("fullName");
    const className = localStorage.getItem("className");
    const timestamp = new Date().toISOString();

    const responseData = {
        fullName,
        className,
        story: questions[currentQuestionIndex].story,
        sliderValue,
        answer1,
        answer2,
        timestamp
    };

    console.log("Sending data:", responseData);

    // Save to JSONBin
    saveAnswerToJSONBin(responseData).catch(error => {
        console.error("Error saving data:", error);
    });

    // Load next question or finish
    if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        loadQuestion(currentQuestionIndex);
    } else {
        document.getElementById("questionnaire-page").style.display = "none";
        document.getElementById("thank-you-page").style.display = "block";
        document.getElementById("thank-you-name").innerText = fullName || "Participant";
    }
});

// Start Button Logic
document.getElementById("start-button").addEventListener("click", function () {
    const fullName = document.getElementById("full-name").value.trim();
    const className = document.getElementById("class-name").value.trim();

    if (fullName === "" || className === "") {
        alert("Please fill out both your Full Name and Class before starting.");
        return;
    }

    localStorage.setItem("fullName", fullName);
    localStorage.setItem("className", className);

    document.getElementById("intro-page").style.display = "none";
    document.getElementById("questionnaire-page").style.display = "block";

    loadQuestion(currentQuestionIndex);
});

// Initial Question Load
loadQuestion(currentQuestionIndex);
</script>

</body>
</html>
